<!doctype html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="In this topic, you will learn how to create a JSON Web Token (JWT) which can be used with Brightcove Playback Restrictions.">
  
  <title>Creating a JSON Web Token (JWT)</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">  
<link rel="preconnect" href="https://fonts.gstatic.com"> 
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/site/prism.css">
  <link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/site/styles.css">
  <link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/learning-paths/learning-paths.css">
  <link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/site/landing-page.css">
  <link rel="stylesheet" href="https://support.brightcove.com/site-assets/css/site/tabs.css">
  <link rel="stylesheet" href="/assets/css/local.css">
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap" rel="stylesheet">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55736414-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55736414-4');
</script>

  <script src="/assets/js/sajari-head.js"></script>
</head>

<body class="body">

<header>
  <div class="div-header">
    <a href="/"><img class="product-logo" src="https://support.brightcove.com/site-assets/images/site/product-logos/SVG/COVE004_Brightcove_Video_Cloud_Logo_RGB_K.svg" alt="Brightcove"></a>
<!-- GTranslate: https://gtranslate.io/ -->
<select onchange="doGTranslate(this);"><option value="">Select Language</option><option value="en|en" translate="No">English</option><option value="en|zh-TW" translate="No">繁體中文</option><option value="en|fr" translate="No">Français</option><option value="en|de" translate="No">Deutsche</option><option value="en|ja" translate="No">日本語</option><option value="en|ko" translate="No">한국어</option><option value="en|es" translate="No">Español</option></select>

<script>
/* <![CDATA[ */
function doGTranslate(lang_pair) {if(lang_pair.value)lang_pair=lang_pair.value;if(lang_pair=='')return;var lang=lang_pair.split('|')[1];var plang=location.hostname.split('.')[0];if(plang.length !=2 && plang.toLowerCase() != 'zh-cn' && plang.toLowerCase() != 'zh-tw')plang='en';location.href=location.protocol+'//'+(lang == 'en' ? '' : lang+'.')+location.hostname.replace('www.', '').replace(RegExp('^' + plang + '\\.'), '')+location.pathname+location.search;}
/* ]]> */
</script>



    <span class="secondary-nav"><a href="https://supportportal.brightcove.com"><i data-feather="help-circle"></i> Contact Support</a> <span style="vertical-align: middle;margin-left:1em;margin-right:1em;">|</span> <a href="https://status.brightcove.com/"><i data-feather="cloud"></i> System Status</a></span>
    <br>

  </div>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb arr-right">
    
    <li class="breadcrumb-item first-item"><a href="/">Home</a></li>
    
      
        <li class="breadcrumb-item"><a href="/developer/">Developer</a></li>
      
    
      
        <li class="breadcrumb-item active" aria-current="page">Creating a JSON Web Token (JWT)</li>
      
    
  </nav>
</header>
<div class="container">
    <div class="row">
      <div class="col-sm-3 left-side-bar">
				<select id="site_select" class="bcls-select" style="margin-left: 1rem;">
					<option value="">Other Brightcove Docs</option>
					
						
							<option value="https://support.brightcove.com">Documentation Home</option>
						
					
						
							<option value="">-- VIDEO CLOUD --</option>
						
					
						
							<option value="https://studio.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Video Cloud Studio</option>
						
					
						
							<option value="https://player.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Player Development</option>
						
					
						
							<option value="https://apis.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Video Cloud Platform APIs</option>
						
					
						
							<option value="https://sdks.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Video Cloud Device SDKs</option>
						
					
						
							<option value="https://integrations.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Integrations and CMS Connectors</option>
						
					
						
							<option value="https://general.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Video Cloud General Information</option>
						
					
						
							<option value="">-- VIDEO ESSENTIALS --</option>
						
					
						
							<option value="https://beacon.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Beacon</option>
						
					
						
							<option value="https://live.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Live</option>
						
					
						
							<option value="https://zencoder.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Zencoder</option>
						
					
						
							<option value="">-- VIDEO CLOUD ADD-ONS --</option>
						
					
						
							<option value="https://campaign.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Campaign</option>
						
					
						
							<option value="https://engage.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Engage</option>
						
					
						
							<option value="https://gallery.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Gallery</option>
						
					
						
							<option value="https://studio.support.brightcove.com/social/index.html">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove Social</option>
						
					
						
							<option value="https://ssai.support.brightcove.com">&nbsp;&nbsp;&nbsp;&nbsp;Brightcove SSAI</option>
						
					
				</select>
        <nav class="sidenav" id="side_nav">
          
            
            <h5><a href="/index.html">Home</a></h5>
            
          
            
              <h5 class="submenu-header"><a href="/general/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;General Information</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/general/brightcove-product-overview.html">Brightcove Product Overview</a></li>
                  
                
                  
                    <li><a href="/general/brightcove-continuum-overview.html">Brightcove Continuum Overview</a></li>
                  
                
                  
                    <li><a href="/general/roku-trick-play.html">Brightcove Videos on Roku Trick Play</a></li>
                  
                
                  
                    <li><a href="/general/brightcove-open-source-projects.html">Open Source Projects</a></li>
                  
                
                  
                    <li><a href="/general/mpeg-dash-video.html">MPEG-DASH Video</a></li>
                  
                
                  
                    <li><a href="/general/brightcove-forum-groups-and-email-lists.html">Brightcove Forum Groups and Email Lists</a></li>
                  
                
              </ul>
            
          
            
              <h5 class="submenu-header"><a href="/developer/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;Developers</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/developer/concepts-cors.html">Understanding CORS</a></li>
                  
                
                  
                    <li><a href="/developer/concepts-introducing-json.html">Introducing JSON</a></li>
                  
                
                  
                    <li><a href="/developer/concepts-javascript-debugging-basics.html">JavaScript Debugging Basics</a></li>
                  
                
                  
                    <li><a href="/developer/concepts-javascript-module-design-pattern.html">The JavaScript Module Design Pattern</a></li>
                  
                
                  
                    <li><a href="/developer/concepts-set-curl.html">Setting up cURL</a></li>
                  
                
                  
                    <li><a href="/developer/concepts-using-javascript-promises.html">Using JavaScript Promises</a></li>
                  
                
                  
                    <li><a href="/developer/create-json-web-token.html">Creating a JSON Web Token (JWT)</a></li>
                  
                
                  
                    <li><a href="/developer/debugging-mobile-devices.html">Debugging on Mobile Devices</a></li>
                  
                
                  
                    <li><a href="/developer/using-mtr-to-look-at-network-traffic.html">Using MTR (my traceroute)</a></li>
                  
                
                  
                    <li><a href="/developer/using-wireshark-track-network-traffic-debugging.html">Using Wireshark to Track Network Traffic</a></li>
                  
                
              </ul>
            
          
            
              <h5 class="submenu-header"><a href="/ooyala/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;Migrating from Ooyala</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/ooyala/migration-docs-ooyala-customers.html">Migration Docs for Ooyala Customers</a></li>
                  
                
                  
                    <li><a href="/ooyala/migrating-analytics-rest-api-brightcove-analytics-api.html">Migrating to the Brightcove Analytics API</a></li>
                  
                
                  
                    <li><a href="/ooyala/migrating-video-cloud-ad-sets.html">Migrating to Video Cloud: Ad Sets</a></li>
                  
                
                  
                    <li><a href="/ooyala/migrating-video-cloud-ingestion-adapter.html">Migrating to Video Cloud: Ingestion Adapter</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-csv-manifest-files.html">Ingestion Adapter: CSV Manifest Files</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-aspera.html">Ingestion Adapter: Ingesting with Aspera</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-ftps.html">Ingestion Adapter: Ingesting with FTPS</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-ois-25.html">Ingestion Adapter: Ingesting with OIS 2.5</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-backlot-api.html">Ingestion Adapter: Ingesting with the Backlot API</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-remote-assets-mrss.html">Ingestion Adapter: Ingesting Remote Assets via MRSS</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-ingesting-remotely-hosted-mrss-feed.html">Ingestion Adapter: Ingesting from Hosted MRSS</a></li>
                  
                
                  
                    <li><a href="/ooyala/backlot-video-cloud-cms-connector.html">Backlot / Video Cloud CMS Connector</a></li>
                  
                
                  
                    <li><a href="/ooyala/backlot-and-video-cloud-video-and-playlist-fields.html">Backlot and Video Cloud: Video and Playlist Fields</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-manifest-file-formats.html">Ingestion Adapter: Manifest File Formats</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-adapter-xml-manifest-files.html">Ingestion Adapter: XML Manifest Files</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-ingestion-supported-ingest-formats.html">Ingestion Adapter: Supported Ingest Formats</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-migration-adding-brightcove-dns-server-testing.html">Adding the Brightcove DNS Server for Testing</a></li>
                  
                
                  
                    <li><a href="/ooyala/ooyala-video-cloud-migration-authentication-brightcove-api-requests.html">Authentication for Brightcove API Requests</a></li>
                  
                
                  
                    <li><a href="/ooyala/trending-now-report-reference.html">Trending Now Report Reference</a></li>
                  
                
                  
                    <li><a href="/ooyala/using-ooyala-players-deliver-video-cloud-content.html">Using Ooyala Players for Video Cloud Content</a></li>
                  
                
              </ul>
            
          
            
              <h5 class="submenu-header"><a href="/utilities/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;Utilities</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/utilities/base-64-encoding-tool.html">Base 64 Encoding Tool</a></li>
                  
                
                  
                    <li><a href="/utilities/date-converter.html">Date Converter</a></li>
                  
                
                  
                    <li><a href="/utilities/string-encoder.html">String Encoder</a></li>
                  
                
              </ul>
            
          
            
              <h5 class="submenu-header"><a href="/training/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;Training</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/training/online-training-courses.html">All Online Training Courses</a></li>
                  
                
                  
                    <li><a href="/training/register-training.html">Register for Instructor-led Training</a></li>
                  
                
                  
                    <li><a href="/training/training-demand-introduction-video-cloud.html">Training: Introduction to Video Cloud</a></li>
                  
                
                  
                    <li><a href="/training/training-demand-introduction-video-cloud-analytics.html">Training:  Introduction to Video Cloud Analytics</a></li>
                  
                
                  
                    <li><a href="/training/training-demand-video-cloud-basics.html">Training: Video Cloud Basics</a></li>
                  
                
                  
                    <li><a href="/training/video-cloud-studio-training-videos.html">Video Cloud Studio Training Videos</a></li>
                  
                
                  
                    <li><a href="/training/brightcove-university.html">Brightcove University Training Courses</a></li>
                  
                
              </ul>
            
          
            
              <h5 class="submenu-header"><a href="/support/index.html"><span style="color:#8E9093">+</span>&nbsp;&nbsp;Support</a></h5>
              <ul class="sidenav-submenu" style="display:none;">
                
                  
                    <li><a href="/support/known-issues-studio-brightcove-player-and-apis.html">Known Issues</a></li>
                  
                
                  
                    <li><a href="/support/viewing-brightcove-system-status-page.html">Viewing the Brightcove System Status Page</a></li>
                  
                
                  
                    <li><a href="/support/contact-sales.html">Contact Sales</a></li>
                  
                
                  
                    <li><a href="/support/opening-case-with-brightcove-support.html">Opening a Support Case</a></li>
                  
                
                  
                    <li><a href="/support/reset-support-portal-password.html">Reset Your Support Portal Password</a></li>
                  
                
              </ul>
            
          
      </nav>
    </div>
    <div class="col-lg-7" style="background-color: white;color: #333333;margin-top: -1em;margin-bottom: -1em;padding-bottom:1em;">
  <!-- bootstrap layout -->

<p id="bc_veggie_burger_wrapper" style="display: none;"><img id="bc_veggie_burger" src="/assets/images/feather/menu.svg" alt="Navigation Menu"></p>

<!-- search bar -->
<div id="nav-search-box" style="margin-top: 1rem;"></div>
<!-- in-page navigation for narrow screens -->
<details class="centered-inpage-nav" id="centered_inpage_nav">
  <summary><h6 class="toc">Page Contents</h6></summary>
  <nav id="centered_toc"></nav>
  <ul id="centered_in_page_toc" class="list-none"></ul>
</details>
<!-- open in new tab/window -->
<a id="open_new_tab" href="#" target="_blank" style="display: none;"><img src="/assets/images/feather/external-link.svg" alt="open in new tab" style="margin-top:4em;width: 1.5em;"></a>




<h1>Creating a JSON Web Token (JWT)</h1>
<article class="bcls-article">
  <summary>In this topic, you will learn how to create a <span translate="No">JSON Web Token</span> (JWT) which can be used with Brightcove Playback Restrictions.</summary> 

  <section class="bcls-section">
    <h2 id="Introduction">Introduction</h2>

    <p>To add an extra level of protection when accessing your video library, or to apply user-level restrictions for your content, you can pass a <span translate="No">JSON Web Token (JWT)</span> with your call to the Brightcove Playback API. To create the token, follow these steps:</p>
    <ol class="bcls-tasklist">
      <li><a href="#Generate_public_private_key_pair">Generate public-private key pair</a></li>
      <li>
        <a href="#Register_public_key">Register public key with Brightcove</a>
      </li>
      <li>
        <a href="#Create_a_JSON_Web_Token">Create a <span translate="No">JSON Web Token</span></a>
      </li>
      <li>
        <a href="#Test_playback">Test playback</a>
      </li>
    </ol>
  </section>

  <section class="bcls-section">
    <h2 id="Generate_public_private_key_pair">Generate public-private key pair</h2>

    <p>You (the publisher) will generate a public-private key pair and provide the public key to Brightcove. You will use the private key to sign tokens. The private key is not shared with Brightcove.</p>

    <p>
      There are many ways to generate the public-private key pair. Here are some examples:
    </p>
    <h3>
      Example bash script:
    </h3>
    <aside class="bcls-aside bcls-aside--information">Note that the script below uses the <strong>jq</strong> package for parsing JSON. If you do not have jq installed see the <a href="https://github.com/stedolan/jq/wiki/Installation">installation instructions</a>.</aside>
    <p>
      Example script to generate the key pair:
    </p>
    <pre class="line-numbers"><code class="language-bash" translate="No">#!/bin/bash
set -euo pipefail

NAME=${1:-}
test -z "${NAME:-}" &amp;&amp; NAME="brightcove-playback-auth-key-$(date +%s)"
mkdir "$NAME"

PRIVATE_PEM="./$NAME/private.pem"
PUBLIC_PEM="./$NAME/public.pem"
PUBLIC_TXT="./$NAME/public_key.txt"

ssh-keygen -t rsa -b 2048 -m PEM -f "$PRIVATE_PEM" -q -N ""
openssl rsa -in "$PRIVATE_PEM" -pubout -outform PEM -out "$PUBLIC_PEM" 2&gt;/dev/null
openssl rsa -in "$PRIVATE_PEM" -pubout -outform DER | base64 &gt; "$PUBLIC_TXT"

rm "$PRIVATE_PEM".pub

echo "Public key to saved in $PUBLIC_TXT"
</code></pre>
    <p>
      Run the script:
    </p>
    <pre><code class="language-bash" translate="No">$ bash keygen.sh
</code></pre>

    <details id="Example_using_Go">
      <summary>Example using <span translate="No">Go</span></summary>
      <p>
        Example using the <span translate="No">Go</span> programming language to generate the key pair:
      </p>
      <aside class="bcls-aside bcls-aside--tip">If you are new to <span translate="No">Go</span>, see the <a href="https://golang.org/">The <span translate="No">Go</span> Programming Language</a> homepage.</aside>
      <pre class="line-numbers"><code class="language-bash" translate="No">package main
  
  import (
    "crypto/rand"
    "crypto/rsa"
    "crypto/x509"
    "encoding/base64"
    "encoding/pem"
    "flag"
    "fmt"
    "io/ioutil"
    "os"
    "path"
    "strconv"
    "time"
  )
  
  func main() {
    var out string
  
    flag.StringVar(&amp;out, "output-dir", "", "Output directory to write files into")
    flag.Parse()
  
    if out == "" {
      out = "rsa-key_" + strconv.FormatInt(time.Now().Unix(), 10)
    }
  
    if err := os.MkdirAll(out, os.ModePerm); err != nil {
      panic(err.Error())
    }
  
    priv, err := rsa.GenerateKey(rand.Reader, 2048)
    if err != nil {
      panic(err.Error())
    }
  
    privBytes := x509.MarshalPKCS1PrivateKey(priv)
  
    pubBytes, err := x509.MarshalPKIXPublicKey(priv.Public())
    if err != nil {
      panic(err.Error())
    }
  
    privOut, err := os.OpenFile(path.Join(out, "private.pem"), os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0600)
    if err != nil {
      panic(err.Error())
    }
  
    if err := pem.Encode(privOut, &amp;pem.Block{Type: "RSA PRIVATE KEY", Bytes: privBytes}); err != nil {
      panic(err.Error())
    }
  
    pubOut, err := os.OpenFile(path.Join(out, "public.pem"), os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0600)
    if err != nil {
      panic(err.Error())
    }
  
    if err := pem.Encode(pubOut, &amp;pem.Block{Type: "PUBLIC KEY", Bytes: pubBytes}); err != nil {
      panic(err.Error())
    }
  
    var pubEnc = base64.StdEncoding.EncodeToString(pubBytes)
  
    var pubEncOut = path.Join(out, "public_key.txt")
    if err := ioutil.WriteFile(pubEncOut, []byte(pubEnc+"\n"), 0600); err != nil {
      panic(err.Error())
    }
  
    fmt.Println("Public key saved in " + pubEncOut)
  }
  </code></pre>
    </details>
    <br>

    <details id="Example_using_node_js">
      <summary>Example using node.js</summary>
      <p>
        Example using node.js to generate the key pair:
      </p>
      <aside class="bcls-aside bcls-aside--tip">This script example requires node version 11 or later.</aside>
      <pre class="line-numbers"><code class="language-javascript" translate="No">var crypto = require("crypto");
  var fs = require("fs");
  
  var now = Math.floor(new Date() / 1000);
  var dir = "rsa-key_" + now;
  fs.mkdirSync(dir);
  
  crypto.generateKeyPair(
    "rsa",
    {modulusLength: 2048},
    (err, publicKey, privateKey) =&gt; {
      fs.writeFile(
        dir + "/public.pem",
        publicKey.export({ type: "spki", format: "pem" }),
        err =&gt; {}
      );
      fs.writeFile(
        dir + "/public_key.txt",
        publicKey.export({ type: "spki", format: "der" }).toString("base64") +
          "\n",
        err =&gt; {}
      );
      fs.writeFile(
        dir + "/private.pem",
        privateKey.export({ type: "pkcs1", format: "pem" }),
        err =&gt; {}
      );
    }
  );
  
  console.log("Public key saved in " + dir + "/public_key.txt");</code></pre>
    </details>
  </section>

  <section class="bcls-section">
    <h2 id="Register_public_key">Register public key</h2>
    <p>You own the private key, and you will use it to generate signed tokens. You will share the public key with Brightcove to verify your tokens. The key API allows you to register your public key with Brightcove.</p>

    <p>For API details, see the <a href="https://apis.support.brightcove.com/playback-restrictions/guides/authentication-apis.html">Using Authentication APIs</a> document.</p>
  </section>

  <section class="bcls-section">
    <h2 id="Create_a_JSON_Web_Token">Create a <span translate="No">JSON Web Token</span></h2>

    <p>Publishers create a <a href="https://jwt.io/introduction/" translate="No">JSON Web Token</a> (JWT). The token is signed with the RSA algorithm using the SHA-256 hash algorithm (identified in the JWT spec as "<a href="https://ldapwiki.com/wiki/RS256">RS256</a>") No other JWT algorithms will be supported.</p>
    <p>
      A subset of the standard <a href="https://auth0.com/docs/tokens/jwt-claims" translate="No">JSON Web Token claims</a> will be used, along with some private claims defined by Brightcove. You will create a <span translate="No">JSON Web Token</span> signed with your private key.
    </p>
  </section>

    <section class="bcls-section">
      <h2 id="Claims_for_Static_URL_Delivery">Claims for Static URL Delivery</h2>
      <p>
        The following claims can be used with Brightcove's Static URL Delivery.
      </p>
      <aside class="bcls-aside bcls-aside--tip">Notice that none of the claims are required for Static URL Delivery.</aside>

      <table class="bcls-table">
        <thead class="bcls-table__head">
          <tr>
            <th>Field</th>
            <th>Type</th>
            <th>Required</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody class="bcls-table__body">
          <tr>
            <td><code translate="No">accid</code></td>
            <td>String</td>
            <td></td>
            <td>The account id that owns the content being played</td>
          </tr>
          <tr>
            <td><code translate="No">drules</code></td>
            <td>String[]</td>
            <td></td>
            <td>List of delivery rule action IDs to apply. For details, see the <a href="https://apis.support.brightcove.com/delivery-rules/getting-started/implementing-delivery-rules.html">Implementing Delivery Rules</a> document.
              <br><br>
              <aside class="bcls-aside bcls-aside--information">
                Setting this claim in the JWT overrides:
                <ul>
                  <li>The <code translate="No">config_id</code> query parameter</li>
                  <li>Any other rule ids set at the account level</li>
                </ul>
              </aside>
            </td>
          </tr>
          <tr>
            <td><code translate="No">exp</code></td>
            <td>Integer</td>
            <td></td>
            <td>Time this token will no longer be valid, in seconds since the Epoch. Must be no more than 30 days from <code translate="No">iat</code></td>
          </tr>
          <tr>
            <td><code translate="No">iat</code></td>
            <td>Integer</td>
            <td></td>
            <td>Time this token was issued, in seconds since the Epoch</td>
          </tr>
          <tr>
            <td><code translate="No">conid</code></td>
            <td>String</td>
            <td></td>
            <td>If present, this token will only authorize license fetching for a specific Video Cloud video ID.
              <br><br>
              Must be a valid video ID. Note that reference ID is not supported.
            </td>
          </tr>
          <tr>
            <td><code translate="No">pro</code></td>
            <td>String</td>
            <td></td>
            <td>Specifies a protection type in the case where multiple are available for a single video.
              <br><br>
              Values:
              <ul>
                <li>
                  "" (default for clear content)
                </li>
                <li>
                  "aes128"
                </li>
                <li>
                  "widevine"
                </li>
                <li>
                  "playready"
                </li>
                <li>
                  "fairplay"
                </li>
              </ul>
            </td>
          </tr>
          <tr>
            <td><code translate="No">vod</code></td>
            <td>Object</td>
            <td></td>
            <td>Contains specific configuration options for Video-On-Demand.</td>
          </tr>
          <tr>
            <td><code translate="No">vod.ssai</code></td>
            <td>String</td>
            <td></td>
            <td>Your Server-Side Ad Insertion (SSAI) configuration id. This claim is <strong>required</strong> to retrieve either an HLS or a DASH VMAP.</td>
          </tr>
        </tbody>
      </table>
      <br>
      <p>
        Here is an example of the <span translate="No">JSON Web Token</span> (JWT) claims that you might use:
      </p>
      <pre class="line-numbers"><code class="language-json" translate="No">{
// account id: JWT is only valid for this accounts
"accid":"4590388311111",
// drules: list of delivery rule IDs to be applied
"drules": ["0758da1f-e913-4f30-a587-181db8b1e4eb"]
// expires: timestamp when JWT expires
"exp":1577989732,
// issued at: timestamp when the JWT was created
"iat":1575484132,
// content id: JWT is only valid for video ID
"conid":"5805807122222",
// protection: specify a protection type in the case where multiple are available for a single video
"pro":"aes128",
// VOD specific configuration options
"vod":{
// SSAI configuration to apply
"ssai":"efcc566-b44b-5a77-a0e2-d33333333333"
}
}</code></pre>
    </section>

    <section class="bcls-section">
      <h2 id="Claims_for_Playback_Restrictions">Claims for Playback Restrictions</h2>
      <p>
        The following claims can be used with <a href="https://apis.support.brightcove.com/playback-restrictions/getting-started/overview-playback-restrictions.html">Brightcove Playback Restrictions</a>.
      </p>
      <aside class="bcls-aside bcls-aside--information">When using Playback Rights with DRM, you can not use AES-128.</aside>
      <aside class="bcls-aside bcls-aside--information">The General required fields are required for all features.</aside> 

      <table class="bcls-table">
        <thead class="bcls-table__head">
          <tr>
            <th style="border-bottom:1px solid #707070;">Feature</th>
            <th style="border-bottom:1px solid #707070;">Field</th>
            <th style="border-bottom:1px solid #707070;">Type</th>
            <th style="border-bottom:1px solid #707070;">Required for feature</th>
            <th style="border-bottom:1px solid #707070;">DRM only</th>
            <th style="border-bottom:1px solid #707070;">Description</th>
          </tr>
        </thead>
        <tbody class="bcls-table__body">
          <tr>
            <td rowspan="3" style="background-color:#dbdbdb;font-weight: bold;border-bottom:1px solid #707070;">General</td>
            <td><code translate="No">accid</code></td>
            <td>String</td>
            <td>Yes</td>
            <td></td>
            <td>The account id that owns the content being played</td>
          </tr>
          <tr>
            <td><code translate="No">exp</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td></td>
            <td>Time this token will no longer be valid, in seconds since the Epoch. Must be no more than 30 days from <code translate="No">iat</code></td>
          </tr>
          <tr>
            <td><code translate="No">iat</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td></td>
            <td>Time this token was issued, in seconds since the Epoch</td>
          </tr>
          <tr>
            <td rowspan="5" style="background-color:#dbdbdb;font-weight: bold;border-bottom:1px solid #707070;">Playback Rights</td>
            <td><code translate="No">pkid</code></td>
            <td>String</td>
            <td></td>
            <td></td>
            <td>The public key id used to verify this token.
              <br><br>
              The public key registered with Brightcove's Playback Authorization Service must use the RSA key format. Previously created EC keys will not work.
              <br><br>
              This field is not required and not validated
            </td>
          </tr>
           <tr>
            <td><code translate="No">nbf</code></td>
            <td>Integer</td>
            <td></td>
            <td></td>
            <td>Time this token will begin being valid, in seconds since the Epoch</td>
          </tr>
          <tr>
            <td><code translate="No">prid</code></td>
            <td>String</td>
            <td></td>
            <td></td>
            <td>A <code translate="No">playback_rights_id</code>. Used to override the id set in the catalog for this video
              <br><br>
              This field is not validated
            </td>
          </tr>
           <tr>
            <td><code translate="No">tags</code></td>
            <td>Array &lt;Strings&gt;</td>
            <td></td>
            <td></td>
            <td>if present, this token is only valid for videos that have the listed tags values. Only these videos are authorized for playback.</td>
          </tr>
          <tr>
            <td><code translate="No">vids</code></td>
            <td>Array &lt;Strings&gt;</td>
            <td></td>
            <td></td>
            <td>If present, this token will only authorize license fetching for a set of video IDs.</td>
          </tr>
          <tr>
            <td rowspan="4" style="background-color:#dbdbdb;font-weight: bold;border-bottom:1px solid #707070;">License Keys Protection</td>
            <td><code translate="No">ua</code></td>
            <td>String</td>
            <td></td>
            <td></td>
            <td>If present, this token will only be valid for requests from this User-Agent.
              <br><br>
              This field does not have to follow any particular format.
              <br>
              You must have <strong>License Keys Protection</strong> enabled.
            </td>
          </tr>
          <tr>
            <td><code translate="No">conid</code></td>
            <td>String</td>
            <td></td>
            <td></td>
            <td>If present, this token will only authorize license fetching for a specific Video Cloud video id.
              <br><br>
              Must be a valid video id
              <br>
              You must have <strong>License Keys Protection</strong> enabled.
            </td>
          </tr>
          <tr>
            <td><code translate="No">maxip</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td></td>
            <td>If present, this token will only be able to be used by this number different IP addresses. 
              <br><br>
              <strong>Required</strong> for session tracking; HLSe (AES-128) only
              <br>
              You must have <strong>License Keys Protection</strong> enabled.
            </td>
          </tr>
          <tr>
            <td><code translate="No">maxu</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td></td>
            <td>
              If present, this token will only be valid for this number of license requests.
              <br><br>
              <ul>
                <li>
                  For HLSe, players will make multiple requests when playing a video, typically one per rendition. The <code translate="No">maxu</code> must be set high enough to account for these additional requests.
                </li>
                <!-- <li>
                  For DRM, one license request is made per playback
                </li> -->
              </ul>
              <strong>Required</strong> for session tracking; HLSe (AES-128) only
              <br>
              You must have <strong>License Keys Protection</strong> enabled.
            </td>
          </tr>
          <tr>
            <td rowspan="5" style="background-color:#dbdbdb;font-weight: bold;border-bottom:1px solid #707070;">Concurrent streams</td>
            <td><code translate="No">uid</code></td>
            <td>String</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>The user id of the end viewer. This field is used to correlate multiple sessions to enforce Stream Concurrency.
              <br><br>
              <strong>Required</strong> for session concurrency
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
          <tr>
            <td><code translate="No">climit</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>When this field is included, it enables Stream Concurrency checking along with license renewal requests. This value indicates the number of concurrent watchers allowed.
              <br><br>
              <strong>Required</strong> for session concurrency
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
          <tr>
            <td><code translate="No">cbeh</code></td>
            <td>String</td>
            <td></td>
            <td>Yes</td>
            <td>Set the value to <code translate="No">BLOCK_NEW</code> to enable concurrent stream limits to block any new request, even from the same user, when the maximum number of streams is reached.
              <br><br>
              Set the value to <code translate="No">BLOCK_NEW_USER</code> to block any new request only from a new user when the maximum number of streams is reached.
              <br><br>
              The default blocks the oldest stream when the maximum number of streams is reached.
            </td>
            <!-- <td>DRM only</td> -->
          </tr>   
          <tr>
            <td><code translate="No">cexp</code></td>
            <td>String</td>
            <td></td>
            <td>Yes</td>
            <td>Concurrency expiration of session - Defaults to 2 times the content duration.
              <br><br>
              This defines how long the session is valid, after which time the end viewer has to start a new session to continue playback. Example: <code translate="No">2h</code> or <code translate="No">42m</code>
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
          <tr>
            <td><code translate="No">sid</code></td>
            <td>String</td>
            <td></td>
            <td>Yes</td>
            <td>Specifying the Session ID of the current stream allows you to control how a session is defined. By default, a session is defined as User-Agent (browser) + IP address + video id.
              <br><br>
                For example, you can loosen the definition of session to IP address + video ID
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
          <tr>
            <td rowspan="2" style="background-color:#dbdbdb;font-weight: bold;border-bottom:1px solid #707070;">Device limits</td>
            <td><code translate="No">uid</code></td>
            <td>String</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>The user id of the end viewer. This field is used to correlate multiple sessions to enforce Stream Concurrency.
              <br><br>
              <strong>Required</strong> for device registration
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
          <tr>
            <td><code translate="No">dlimit</code></td>
            <td>Integer</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>When this field is included, it controls how many devices can be associated with the specified user (<code translate="No">uid</code>). Value must be &gt; <code translate="No">0</code>.
              <br><br>
              Previously allowed devices will continue to operate if the <code translate="No">dlimit</code> value is dropped in later requests.
              <br><br>
              Example: if value is set to <code translate="No">3</code>, the user can play on devices A, B, & C (all would be allowed). Trying to play on device D would be denied.
              <br><br>
              If value is changed to <code translate="No">1</code>, the user can still play on all 3 devices A, B, & C, unless the devices are manually revoked by managing devices with the <a href="https://apis.support.brightcove.com/playback-rights/references/devices-api/reference.htmlc/#operation/GetDevices">Playback Rights API</a>.
              <br><br>
              <strong>Required</strong> for device registration
            </td>
            <!-- <td>DRM only</td> -->
          </tr>
        </tbody>
      </table>

      <h3>Claims by tier</h3>
      <p>Several security packages are available for Playback Restrictions. For details, see the <a href="https://apis.support.brightcove.com/playback-restrictions/getting-started/overview-playback-restrictions.html">Overview: Brightcove Playback Restrictions</a> document.</p>
      <p>Here are the claims available for each Playback Restriction package:</p>
    <table class="bcls-table">
      <thead class="bcls-table__head"> 
        <tr>
          <th>Feature</th>
          <th>Claims</th>
          <th>Security Tier 1</th>
          <th>Security Tier 2</th>
          <th>Security Tier 3</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td rowspan="3">General</td>
          <td>accid</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>exp</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>iat</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td rowspan="5">Playback Rights <sup><a href="#n1"> [1]</a></sup></td>
          <td>pkid</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>nbf</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>prid</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>tags</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>vids</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td rowspan="4">License Keys Protection</td>
          <td>ua</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>conid</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>maxip</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>maxu</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td rowspan="5">Concurrent streams</td>
          <td>uid</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>climit</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>cbeh</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>cexp</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>sid</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td rowspan="2">Device registration</td>
          <td>uid</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
        <tr>
          <td>dlimit</td>
          <td style="text-align: center;">No</td>
          <td style="text-align: center;">No</td>
          <td style="background-color: #D7F6E6;text-align: center;">Yes</td>
        </tr>
      </tbody>
    </table>
    <br/>
    <aside class="bcls-aside bcls-aside--information">
      <p>The following note refers to the table above.</p>
      
      <p id="n1"><sup>[1]</sup> All claims associated with Playback Rights are optional. So, you do not need to create a JWT to use Playback Rights.</p>
      <p>In Video Cloud Studio Admin, when creating new <strong>Playback Rights</strong>, you can select <strong>Allow Playback Right without token</strong>. </p>
      </aside>
    </section>

    <section class="bcls-section">
      <h2 id="Generate_a_token">Generate a token</h2>
      <p>
        Libraries are commonly available to generate JWT tokens. For details, see the <a href="https://jwt.io/" translate="No">JSON Web Tokens</a> site.
      </p>
      <h4>
        Example bash script:
      </h4>
      <p>
        Example script to generate the JWT token:
      </p>
      <pre class="line-numbers"><code class="language-bash" translate="No">#! /usr/bin/env bash
# Static header fields.
HEADER='{
	"type": "JWT",
	"alg": "RS256"
}'

payload='{
	"accid": "{your_account_id}"
}'

# Use jq to set the dynamic `iat` and `exp`
# fields on the payload using the current time.
# `iat` is set to now, and `exp` is now + 1 second.
PAYLOAD=$(
	echo "${payload}" | jq --arg time_str "$(date +%s)" \
	'
	($time_str | tonumber) as $time_num
	| .iat=$time_num
	| .exp=($time_num + 60 * 60)
	'
)

function b64enc() { openssl enc -base64 -A | tr '+/' '-_' | tr -d '='; }

function rs_sign() { openssl dgst -binary -sha256 -sign playback-auth-keys/private.pem ; }

JWT_HDR_B64="$(echo -n "$HEADER" | b64enc)"
JWT_PAY_B64="$(echo -n "$PAYLOAD" | b64enc)"
UNSIGNED_JWT="$JWT_HDR_B64.$JWT_PAY_B64"
SIGNATURE=$(echo -n "$UNSIGNED_JWT" | rs_sign | b64enc)

echo "$UNSIGNED_JWT.$SIGNATURE"
</code></pre>
      <p>
        Run the script:
      </p>
      <pre><code class="language-bash" translate="No">$ bash jwtgen.sh
</code></pre>
      <br>

      <details>
        <summary>
          Example using <span translate="No">Go</span>
        </summary>
        <p>Here is an example of a reference <span translate="No">Go</span> implementation (as a cli tool) for generating tokens without the use of any 3rd party library:</p>
        <pre class="line-numbers"><code class="language-bash" translate="No">package main

import (
	"crypto"
	"crypto/ecdsa"
	"crypto/rand"
	"crypto/rsa"
	"crypto/sha256"
	"crypto/x509"
	"encoding/base64"
	"encoding/json"
	"encoding/pem"
	"flag"
	"fmt"
	"io/ioutil"
	"os"
	"strings"
	"time"
)

// Header is the base64UrlEncoded string of a JWT header for the RS256 algorithm
const RSAHeader = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9"

// Header is the base64UrlEncoded string of a JWT header for the EC256 algorithm
const ECHeader = "eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9"

// Claims represents constraints that should be applied to the use of the token
type Claims struct {
	Iat   float64 `json:"iat,omitempty"`   // Issued At
	Exp   float64 `json:"exp,omitempty"`   // Expires At
	Accid string  `json:"accid,omitempty"` // Account ID
	Conid string  `json:"conid,omitempty"` // Content ID
	Maxu  float64 `json:"maxu,omitempty"`  // Max Uses
	Maxip float64 `json:"maxip,omitempty"` // Max IPs
	Ua    string  `json:"ua,omitempty"`    // User Agent
}

func main() {
	var key, algorithm string

	c := Claims{Iat: float64(time.Now().Unix())}

	flag.StringVar(&amp;key, "key", "", "Path to private.pem key file")
	flag.StringVar(&amp;c.Accid, "account-id", "", "Account ID")
	flag.StringVar(&amp;c.Conid, "content-id", "", "Content ID (eg, video_id or live_job_id)")
	flag.Float64Var(&amp;c.Exp, "expires-at", float64(time.Now().AddDate(0, 0, 1).Unix()), "Epoch timestamp (in seconds) for when the token should stop working")
	flag.Float64Var(&amp;c.Maxu, "max-uses", 0, "Maximum number of times the token is valid for")
	flag.Float64Var(&amp;c.Maxip, "max-ips", 0, "Maximum number of unique IP addresses the token is valid for")
	flag.StringVar(&amp;c.Ua, "user-agent", "", "User Agent that the token is valid for")
	flag.StringVar(&amp;algorithm, "algo", "", "Key algorithm to use for signing. Valid: ec256, rsa256")
	flag.Parse()

	if key == "" {
		fmt.Printf("missing required flag: -key\n\n")
		flag.Usage()
		os.Exit(1)
	}

	if algorithm == "" {
		fmt.Printf("missing required flag: -algo\n\n")
		flag.Usage()
		os.Exit(2)
	}

	if algorithm != "rsa256" &amp;&amp; algorithm != "ec256" {
		fmt.Printf("missing valid value for -algo flag. Valid: rsa256, ec256\n\n")
		flag.Usage()
		os.Exit(3)
	}

	if c.Accid == "" {
		fmt.Printf("missing required flag: -account-id\n\n")
		flag.Usage()
		os.Exit(4)
	}

	bs, err := json.Marshal(c)
	if err != nil {
		fmt.Println("failed to marshal token to json", err)
		os.Exit(5)
	}

	kbs, err := ioutil.ReadFile(key)
	if err != nil {
		fmt.Println("failed to read private key", err)
		os.Exit(6)
	}

	if algorithm == "rsa256" {
		processRSA256(kbs, bs)
	} else {
		processEC256(kbs, bs)
	}
}

func processRSA256(kbs, bs []byte) {
	block, _ := pem.Decode(kbs)
	if block == nil {
		fmt.Println("failed to decode PEM block containing private key")
		os.Exit(7)
	}

	if block.Type != "RSA PRIVATE KEY" {
		fmt.Println("failed to decode PEM block containing private key")
		os.Exit(8)
	}

	pKey, err := x509.ParsePKCS1PrivateKey(block.Bytes)
	if err != nil {
		fmt.Println("failed to parse rsa private key", err)
		os.Exit(9)
	}

	message := RSAHeader + "." + base64.RawURLEncoding.EncodeToString(bs)

	hash := crypto.SHA256
	hasher := hash.New()
	_, _ = hasher.Write([]byte(message))
	hashed := hasher.Sum(nil)

	r, err := rsa.SignPKCS1v15(rand.Reader, pKey, hash, hashed)
	if err != nil {
		fmt.Println("failed to sign token", err)
		os.Exit(10)
	}

	sig := strings.TrimRight(base64.RawURLEncoding.EncodeToString(r), "=")

	fmt.Println(message + "." + sig)
}

func processEC256(kbs, bs []byte) {
	block, _ := pem.Decode(kbs)
	if block == nil {
		fmt.Println("failed to decode PEM block containing private key")
		os.Exit(7)
	}

	if block.Type != "EC PRIVATE KEY" {
		fmt.Println("failed to decode PEM block containing private key")
		os.Exit(8)
	}

	pkey, err := x509.ParseECPrivateKey(block.Bytes)
	if err != nil {
		fmt.Println("failed to parse ec private key", err)
		os.Exit(9)
	}

	message := ECHeader + "." + base64.RawURLEncoding.EncodeToString(bs)
	hash := sha256.Sum256([]byte(message))

	r, s, err := ecdsa.Sign(rand.Reader, pkey, hash[:])
	if err != nil {
		fmt.Println("failed to sign token", err)
		os.Exit(10)
	}

	curveBits := pkey.Curve.Params().BitSize

	keyBytes := curveBits / 8
	if curveBits%8 &gt; 0 {
		keyBytes++
	}

	rBytes := r.Bytes()
	rBytesPadded := make([]byte, keyBytes)
	copy(rBytesPadded[keyBytes-len(rBytes):], rBytes)

	sBytes := s.Bytes()
	sBytesPadded := make([]byte, keyBytes)
	copy(sBytesPadded[keyBytes-len(sBytes):], sBytes)

	out := append(rBytesPadded, sBytesPadded...)

	sig := base64.RawURLEncoding.EncodeToString(out)
	fmt.Println(message + "." + sig)
}
</code></pre>
</details>

      <h4>Results</h4>
      <p>
        Here is an example of a decoded token using <a href="https://jwt.io/">https://JWT.io</a> specifying the full set of claims:
      </p>
      <p>
        HEADER:
      </p>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "alg": "RS256",
  "type": "JWT"
}
</code></pre>

      <p>
        PAYLOAD:
      </p>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "accid": "1100863500123",
  "conid": "51141412620123",
  "exp": 1554200832,
  "iat": 1554199032,
  "maxip": 10,
  "maxu": 10,
  "ua": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36"
}
</code></pre>
    </section>

    <section class="bcls-section">
      <h2 id="Test_playback">Test playback</h2>

      <p>Although not required, you may want to test video playback before configuring a player.</p>
      <p>
        Request playback:
      </p>
      <pre class="line-numbers"><code class="language-http" translate="No">curl -X GET \
 -H 'Authorization: Bearer {JWT}' \
 https://edge-auth.api.brightcove.com/playback/v1/accounts/{your_account_id}/videos/{your_video_id}
</code></pre>
</section>
</article>
<!-- complete bootstrap layout -->
    </div>
    <div class="col-sm-2 right-side-bar">
      
      <nav class="right-side-nav" id="right_side_nav">
        <h6 class="toc">Page Contents</h6>
        <ul id="in_page_nav" class="list-none"></ul>
      </nav>
      
    </div>
  </div>
</div>

<hr>
<div class="last-updated">
  Page last updated on 21 Jul 2021
</div>



<footer class="bcls-footer" role="contentinfo">
  <div class="row">
    <div class="region region-footer-top-center col-md-12">
      <nav role="navigation" aria-labelledby="block-brightcovesupport-menu" id="block-brightcovesupport" class="footer-menu">
        <img src="https://support.brightcove.com/site-assets/images/site/SVG/COVE004_Brightcove_Logo_093020_RGB_KO.svg" class="bc-footer-logo" alt="Brightcove">

        <h2>Brightcove Support</h2>

        <ul class="menu">
          <li>
            <a href="https://status.brightcove.com">System Status</a>
          </li>
          <li>
            <a href="https://supportportal.brightcove.com">Contact Support</a>
          </li>
          <li>
            <a href="https://support.brightcove.com/">Documentation</a>
          </li>
        </ul>

      </nav>
      <nav role="navigation" aria-labelledby="block-training-menu" id="block-training" class="footer-menu">

        <h2>Training</h2>

        <ul class="menu">
          <li>
            <a href="https://studio.support.brightcove.com/training/online-training-courses.html">Online Courses</a>
          </li>
          <li>
            <a href="https://studio.support.brightcove.com/training/register-training.html">Register for a course</a>
          </li>
          <li>
            <a href="https://university.brightcove.com/">Brightcove University</a>
          </li>
        </ul>

      </nav>
      <nav role="navigation" aria-labelledby="block-brightcove-menu" class="footer-menu">

        <h2>Brightcove</h2>

        <ul class="menu">
          <li>
            <a href="https://www.brightcove.com">Brightcove.com</a>
          </li>
          <li>
            <a href="https://supportportal.brightcove.com">Contact Us</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <div class="row">
    <div class="region region-footer-bottom-center col-md-12">
      <div class="bcls-copyright footer-menu">
        <table>
          <tr>
            <td>
              <div id="bc_copyright" class="field field--name-field-copyright-year field--type-string field--label-hidden field--item" style="float: left;"> Brightcove Inc. All rights reserved.</div>
            </td>
            <td><a href="https://www.brightcove.com/en/legal/privacy">Privacy</a> | <a href="https://www.brightcove.com/en/terms-and-conditions">Terms &amp; Conditions</a></td>
            <td>
              <div class="gf-links-cols footer-menu">
                <div class="gf-social"><a href="https://www.linkedin.com/company/16439" title="LinkedIn" newtab="newtab" class="gf-social-linkedin" style="margin-right: 1rem;"><i data-feather="linkedin" style="color:#8E9093;height: 1.25rem;"></i></a><a href="https://twitter.com/brightcove" title="Twitter" newtab="newtab" class="gf-social-twitter" style="margin-right: 1rem;"><i data-feather="twitter" style="color:#8E9093;height: 1.25rem;"></i></a><a href="https://www.facebook.com/Brightcove" title="Facebook" newtab="newtab" class="gf-social-facebook"><i data-feather="facebook" style="color:#8E9093;height: 1.25rem;"></i></a>
                </div>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</footer>

<script>
      
  var searchBox = sajari.init({
    mode: "search-box",
    project: "1588255093746585379", // Set this to your project.
    collection: "brightcove-documenation", // Set this to your collection.
    instantPipeline: "autocomplete", // Pipeline used as you type
    inputPlaceholder: "Search", // Input element placeholder
    maxSuggestions: 5, // Maximum number of suggestions to show
    attachSearchBox: document.getElementById("nav-search-box") // DOM element to attach to
  });
  
    searchBox("sub", "pipeline.search-sent", function (_, query) {
      window.location = "/search.html?q=" + encodeURIComponent(query.q);
    });
  

</script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/https-fix.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/setDate.js"></script>
  
  <script src="https://support.brightcove.com/site-assets/js/site/prism.js"></script>
  
  <script src="https://support.brightcove.com/site-assets/js/site/site.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/learning-paths/learning-paths.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/tabs.js"></script>
  
  <!-- <script src="/assets/js/toc.js"></script> -->
  <script src="https://support.brightcove.com/site-assets/js/site/toc.js"></script>
  
  <script src="/assets/js/sites_nav.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/bcls-utils.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/local-link-fix.js"></script>
  <script src="https://support.brightcove.com/site-assets/js/site/sajari-reindex.js"></script>
  <script src="/assets/js/feedback.js"></script>
  
  <script src="/assets/js/sajari-search-foot.js"></script>
  
  <!-- <script src="/assets/js/sajari-index.js"></script> -->
  <style>
    a.sj-paginator__page-number.sj-paginator__page-number--current.css-so0ov7 {
      background-color: lightblue;
    }
    div.sj-tabs__tab {
      margin-top: 3rem;
      margin-left: .3rem;
      border-top-left-radius: .4rem;
      border-top-right-radius: .4rem;
      background-color:#e8e8e8;
    }

    div.sj-tabs__tab.sj-tabs__tab--selected {
      border-bottom-color: crimson;
      background-color: #f8f8f8;
    }

    p.sj-results__result__description.css-p9jvyt {
      font-size: 1rem;
    }

    .sj-result__text.css-31l7gp h3 {
      color: navy;
      font-size: 1.4rem;
    }
    </style>

</body>

</html>
